# 饮食分析功能

## 功能概述

饮食分析功能是AI医生助理的一个重要组成部分，专门为糖尿病患者和关注健康饮食的用户设计。通过上传食物图片，系统能够识别食物类型、计算营养成分，并提供针对糖尿病的健康建议。

## 主要功能

### 1. 图片上传与识别
- **拍照功能**: 支持直接使用摄像头拍摄食物图片
- **相册选择**: 支持从手机相册选择已有图片
- **图片预览**: 上传后可以预览图片，支持重新选择
- **文件验证**: 只允许上传图片格式文件，大小限制10MB

### 2. AI食物识别
- **多食物识别**: 能够识别图片中的多种食物
- **置信度显示**: 显示每种食物的识别置信度
- **营养信息**: 提供每种食物的详细营养信息

### 3. 营养分析
- **卡路里计算**: 计算总卡路里摄入
- **宏量营养素**: 分析碳水化合物、蛋白质、脂肪含量
- **膳食纤维**: 计算膳食纤维摄入量
- **升糖指数**: 评估食物的升糖指数

### 4. 糖尿病健康评估
- **血糖影响评估**: 分析食物对血糖的影响程度
- **风险等级**: 分为低、中、高三个风险等级
- **个性化建议**: 根据分析结果提供针对性的健康建议

## 技术实现

### 前端技术栈
- **React + TypeScript**: 现代化的前端框架
- **Lucide React**: 图标库
- **CSS3**: 响应式设计和动画效果
- **Axios**: HTTP客户端

### 后端技术栈
- **Node.js + Express**: 服务器框架
- **Multer**: 文件上传处理
- **模拟AI识别**: 目前使用模拟数据，可集成真实AI服务

### API接口

#### 1. 饮食分析接口
```
POST /api/diet-analysis/analyze
Content-Type: multipart/form-data

参数:
- image: 图片文件

响应:
{
  "success": true,
  "data": {
    "recognizedFoods": [...],
    "analysis": {
      "totalCalories": 405,
      "totalCarbs": 33,
      "totalProtein": 30.7,
      "totalFat": 15.5,
      "totalFiber": 3.4,
      "averageGlycemicIndex": 43,
      "estimatedBloodSugarImpact": "低 - 对血糖影响较小",
      "recommendations": [...],
      "diabetesRisk": "low"
    }
  }
}
```

#### 2. 食物数据库接口
```
GET /api/diet-analysis/foods

响应:
{
  "success": true,
  "data": {
    "rice": {
      "name": "白米饭",
      "calories": 130,
      "carbs": 28,
      "protein": 2.7,
      "fat": 0.3,
      "fiber": 0.4,
      "glycemicIndex": 73,
      "servingSize": "100g",
      "confidence": 0.95
    },
    ...
  }
}
```

#### 3. 饮食建议接口
```
GET /api/diet-analysis/recommendations

响应:
{
  "success": true,
  "data": {
    "diabetes": [...],
    "general": [...]
  }
}
```

## 食物数据库

系统内置了常见食物的营养数据库，包括：

### 主食类
- 白米饭 (升糖指数: 73)
- 面条 (升糖指数: 55)
- 面包 (升糖指数: 70)

### 蛋白质类
- 肉类 (升糖指数: 0)
- 鱼类 (升糖指数: 0)
- 鸡蛋 (升糖指数: 0)
- 豆腐 (升糖指数: 15)

### 蔬菜水果
- 蔬菜 (升糖指数: 15)
- 水果 (升糖指数: 40)

### 乳制品
- 牛奶 (升糖指数: 30)

## 糖尿病健康评估标准

### 升糖指数分级
- **低升糖指数 (≤55)**: 对血糖影响较小，适合糖尿病患者
- **中等升糖指数 (56-70)**: 需要适量控制
- **高升糖指数 (>70)**: 可能导致血糖快速上升，需要谨慎

### 风险等级评估
- **低风险**: 平均升糖指数 ≤ 55
- **中等风险**: 平均升糖指数 56-70
- **高风险**: 平均升糖指数 > 70

## 健康建议

### 针对糖尿病患者的建议
1. **控制碳水化合物摄入**: 特别是精制糖和淀粉
2. **选择低升糖指数食物**: 如蔬菜、豆类、全谷物
3. **增加膳食纤维摄入**: 有助于控制血糖
4. **适量运动**: 帮助控制血糖水平
5. **定期监测血糖**: 了解食物对血糖的影响
6. **分餐进食**: 避免暴饮暴食

### 一般健康建议
1. **均衡饮食**: 包含蛋白质、碳水化合物和健康脂肪
2. **多吃蔬菜水果**: 补充维生素和矿物质
3. **控制盐分摄入**: 预防高血压
4. **适量饮水**: 保持身体水分
5. **规律作息**: 保证充足睡眠
6. **定期体检**: 关注身体健康

## 使用说明

### 拍照技巧
1. **光线充足**: 确保食物清晰可见
2. **避免阴影**: 避免遮挡食物细节
3. **角度合适**: 从上方拍摄效果最佳
4. **距离适中**: 不要太远或太近

### 注意事项
1. **图片质量**: 清晰度越高识别越准确
2. **食物种类**: 目前支持常见食物识别
3. **份量估算**: 系统基于标准份量计算
4. **个性化调整**: 建议根据个人情况调整

## 未来扩展

### 计划功能
1. **真实AI集成**: 集成Google Vision API或Azure Computer Vision
2. **个性化推荐**: 基于用户历史数据提供个性化建议
3. **营养追踪**: 记录每日营养摄入
4. **血糖关联**: 与血糖监测设备数据关联
5. **食谱推荐**: 基于分析结果推荐健康食谱

### 技术优化
1. **性能优化**: 提高图片处理速度
2. **准确度提升**: 扩大食物数据库
3. **用户体验**: 优化界面交互
4. **移动端适配**: 更好的移动端体验

## 部署说明

### 环境要求
- Node.js 16+
- npm 或 yarn
- 现代浏览器支持

### 安装依赖
```bash
# 前端依赖
cd frontend
npm install

# 后端依赖
cd backend
npm install
```

### 启动服务
```bash
# 启动后端服务
cd backend
npm start

# 启动前端服务
cd frontend
npm run dev
```

### 访问地址
- 前端: http://localhost:3000
- 后端: http://localhost:8000
- 饮食分析页面: http://localhost:3000/diet-analysis

## 贡献指南

欢迎提交Issue和Pull Request来改进这个功能！

### 开发规范
1. **代码风格**: 遵循项目现有的代码风格
2. **测试覆盖**: 新功能需要包含测试
3. **文档更新**: 及时更新相关文档
4. **性能考虑**: 注意代码性能优化

### 提交规范
- feat: 新功能
- fix: 修复bug
- docs: 文档更新
- style: 代码格式调整
- refactor: 代码重构
- test: 测试相关
- chore: 构建过程或辅助工具的变动 